(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[726],{6132:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},37657:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var t=a(95155),r=a(12115),n=a(86948),i=a(3998),c=a(65142),o=a(76444),d=a(11647),l=a(6132),u=a(42529),h=a(78874),p=a(78519),m=a(70532),y=a(57828),x=a(46046),g=a(90960);function f(){let[e,s]=(0,r.useState)(null),[a,f]=(0,r.useState)(!0),[j,b]=(0,r.useState)(!1),[N,S]=(0,r.useState)(!1),[v,P]=(0,r.useState)({cpfCnpj:"",asaasApiKey:"",asaasSandbox:!1});(0,r.useEffect)(()=>{C()},[]);let C=async()=>{try{f(!0);let e=await g.F.getCurrentUser(),a=(await g.F.getSellers()).find(s=>s.email===e.email);a&&(s(a),P({cpfCnpj:a.cpfCnpj||"",asaasApiKey:"",asaasSandbox:a.asaasSandbox}))}catch(e){console.error("Erro ao carregar configura\xe7\xf5es:",e)}finally{f(!1)}},q=async s=>{if(s.preventDefault(),e){if(!v.cpfCnpj)return void alert("CPF/CNPJ \xe9 obrigat\xf3rio");try{b(!0);let s={cpfCnpj:v.cpfCnpj.replace(/\D/g,""),asaasSandbox:v.asaasSandbox};v.asaasApiKey&&(s.asaasApiKey=v.asaasApiKey),await g.F.updateSeller(e.id,s),alert("Configura\xe7\xf5es salvas com sucesso!"),await C(),P({...v,asaasApiKey:""})}catch(e){alert(e instanceof Error?e.message:"Erro ao salvar configura\xe7\xf5es")}finally{b(!1)}}},w=e=>{let s=e.replace(/\D/g,"");return s.length<=11?s.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"):s.replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})$/,"$1-$2")};return a?(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Carregando..."})}):e?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Configura\xe7\xf5es de Pagamento"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Configure seus dados para receber pagamentos e gerenciar cobran\xe7as"})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Informa\xe7\xf5es do Vendedor"}),(0,t.jsx)(n.BT,{children:"Seus dados cadastrados no sistema"})]}),(0,t.jsxs)(n.Wu,{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-muted-foreground",children:"Nome"}),(0,t.jsx)("p",{className:"font-medium",children:e.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-muted-foreground",children:"Email"}),(0,t.jsx)("p",{className:"font-medium",children:e.email})]}),e.phone&&(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-muted-foreground",children:"Telefone"}),(0,t.jsx)("p",{className:"font-medium",children:e.phone})]})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Status da Conta Asaas"}),(0,t.jsx)(n.BT,{children:"Configura\xe7\xe3o da integra\xe7\xe3o de pagamentos"})]}),(0,t.jsxs)(n.Wu,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(o.J,{className:"text-sm",children:"API Key Configurada"}),e.hasAsaasApiKey?(0,t.jsxs)(d.E,{variant:"default",className:"gap-1",children:[(0,t.jsx)(u.A,{className:"w-3 h-3"}),"Configurada"]}):(0,t.jsxs)(d.E,{variant:"secondary",className:"gap-1",children:[(0,t.jsx)(h.A,{className:"w-3 h-3"}),"N\xe3o configurada"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(o.J,{className:"text-sm",children:"Ambiente"}),(0,t.jsx)(d.E,{variant:e.asaasSandbox?"outline":"default",children:e.asaasSandbox?"Sandbox (Teste)":"Produ\xe7\xe3o"})]}),e.cpfCnpj&&(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-muted-foreground",children:"CPF/CNPJ Cadastrado"}),(0,t.jsx)("p",{className:"font-medium font-mono",children:w(e.cpfCnpj)})]})]})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.A,{className:"w-5 h-5"}),"Configurar Dados de Cobran\xe7a"]}),(0,t.jsx)(n.BT,{children:"Configure seu CPF/CNPJ e API Key do Asaas para receber pagamentos"})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.J,{htmlFor:"cpfCnpj",children:"CPF/CNPJ *"}),(0,t.jsx)(c.p,{id:"cpfCnpj",value:v.cpfCnpj,onChange:e=>{let s=w(e.target.value);P({...v,cpfCnpj:s})},placeholder:"000.000.000-00 ou 00.000.000/0000-00",required:!0}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Usado para identifica\xe7\xe3o nas cobran\xe7as"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.J,{htmlFor:"asaasApiKey",children:"API Key do Asaas"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.p,{id:"asaasApiKey",type:N?"text":"password",value:v.asaasApiKey,onChange:e=>P({...v,asaasApiKey:e.target.value}),placeholder:e.hasAsaasApiKey?"••••••••••••••••":"Cole sua API Key aqui"}),(0,t.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>S(!N),children:N?(0,t.jsx)(m.A,{className:"w-4 h-4"}):(0,t.jsx)(y.A,{className:"w-4 h-4"})})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.hasAsaasApiKey?"Deixe em branco para manter a chave atual":"Obtenha em asaas.com → Integra\xe7\xf5es → API Key"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"sandbox",checked:v.asaasSandbox,onChange:e=>P({...v,asaasSandbox:e.target.checked}),className:"rounded border-gray-300"}),(0,t.jsx)(o.J,{htmlFor:"sandbox",className:"cursor-pointer",children:"Usar ambiente de teste (Sandbox)"})]}),(0,t.jsxs)(i.$,{type:"submit",disabled:j,className:"w-full md:w-auto",children:[(0,t.jsx)(x.A,{className:"w-4 h-4 mr-2"}),j?"Salvando...":"Salvar Configura\xe7\xf5es"]})]})})]}),(0,t.jsxs)(n.Zp,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800",children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{className:"text-blue-900 dark:text-blue-100",children:"ℹ️ Como funciona"})}),(0,t.jsxs)(n.Wu,{className:"text-sm text-blue-800 dark:text-blue-200 space-y-2",children:[(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"CPF/CNPJ:"})," Usado para identificar voc\xea nas cobran\xe7as e transfer\xeancias"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"API Key:"})," Permite que o sistema crie cobran\xe7as em sua conta Asaas"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Sandbox:"})," Use para testes sem movimentar dinheiro real"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Seguran\xe7a:"})," Sua API Key \xe9 criptografada e nunca \xe9 exibida ap\xf3s salvar"]})]})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(l.A,{className:"w-12 h-12 mx-auto mb-4 text-yellow-500"}),(0,t.jsx)("p",{className:"text-lg font-medium",children:"Vendedor n\xe3o encontrado"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Voc\xea precisa estar cadastrado como vendedor para acessar esta p\xe1gina"})]})})}},46046:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},78519:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},89352:(e,s,a)=>{Promise.resolve().then(a.bind(a,37657))},90960:(e,s,a)=>{"use strict";a.d(s,{F:()=>n});let t=a(95704).env.NEXT_PUBLIC_API_URL||"https://neweraapi.squareweb.app";class r{async sleep(e){return new Promise(s=>setTimeout(s,e))}async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={"Content-Type":"application/json",...s.headers},r=null;for(let i=0;i<this.maxRetries;i++)try{let n=new AbortController,c=setTimeout(()=>n.abort(),3e4),o=await fetch("".concat(t).concat(e),{...s,headers:a,credentials:"include",signal:n.signal});if(clearTimeout(c),401===o.status)throw e.includes("/login")||(window.location.href="/login"),Error("N\xe3o autorizado");if(!o.ok){let e=await o.text();if(o.status>=500&&i<this.maxRetries-1){r=Error(e||"Erro ".concat(o.status)),await this.sleep(this.retryDelay*(i+1));continue}throw window.dispatchEvent(new Event("api-offline")),Error(e||"Erro ".concat(o.status))}if(window.dispatchEvent(new Event("api-online")),204===o.status)return{};return o.json()}catch(e){var n;if(("AbortError"===e.name||(null==(n=e.message)?void 0:n.includes("fetch")))&&i<this.maxRetries-1){console.warn("API request failed (attempt ".concat(i+1,"/").concat(this.maxRetries,"):"),e.message),r=e,await this.sleep(this.retryDelay*(i+1));continue}throw e}throw window.dispatchEvent(new Event("api-offline")),r||Error("Falha ao conectar com a API ap\xf3s m\xfaltiplas tentativas")}async login(e,s){return this.request("/api/admin/login",{method:"POST",body:JSON.stringify({email:e,password:s})})}async logout(){await this.request("/api/admin/logout",{method:"POST"})}async healthCheck(){try{return(await fetch("".concat(t,"/health"),{method:"GET",cache:"no-store"})).ok}catch(e){return!1}}async getCurrentUser(){return this.request("/api/admin/me")}async isAuthenticated(){try{return await this.getCurrentUser(),!0}catch(e){return!1}}async getGames(){return this.request("/api/games")}async getGame(e){return this.request("/api/games/".concat(e))}async createGame(e){return this.request("/api/games",{method:"POST",body:JSON.stringify(e)})}async updateGame(e,s){return this.request("/api/games/".concat(e),{method:"PUT",body:JSON.stringify(s)})}async deleteGame(e){return this.request("/api/games/".concat(e),{method:"DELETE"})}async getProducts(e){return this.request("/api/products/game/".concat(e))}async createProduct(e){return this.request("/api/products",{method:"POST",body:JSON.stringify(e)})}async deleteProduct(e){return this.request("/api/products/".concat(e),{method:"DELETE"})}async refreshProductImage(e){return this.request("/api/roblox/refresh-product-image/".concat(e),{method:"POST"})}async updateProduct(e,s){return this.request("/api/products/".concat(e),{method:"PUT",body:JSON.stringify(s)})}async getSalesStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return this.request("/api/payments/stats/period?days=".concat(e))}async getSales(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,a=arguments.length>2?arguments[2]:void 0,t=new URLSearchParams({page:String(e),limit:String(s)});return a&&t.append("days",String(a)),this.request("/api/payments/sales?".concat(t))}async getConfig(){return this.request("/api/config")}async updateConfig(e){return this.request("/api/config",{method:"PUT",body:JSON.stringify(e)})}async notifyBotUpdate(){return this.request("/api/bot/notify-update",{method:"POST"})}async processPlaceholders(e,s){return(await this.request("/api/config/process-placeholders",{method:"POST",body:JSON.stringify({text:e,gamesList:s})})).processedText}async getUsers(){return this.request("/api/admin/users")}async createUser(e){return this.request("/api/admin/register",{method:"POST",body:JSON.stringify(e)})}async deleteUser(e){return this.request("/api/admin/users/".concat(e),{method:"DELETE"})}async updateUser(e,s){return this.request("/api/admin/users/".concat(e),{method:"PATCH",body:JSON.stringify(s)})}async uploadImage(e){let s=new FormData;s.append("file",e);let a=await fetch("".concat(t,"/api/upload/image"),{method:"POST",credentials:"include",body:s});if(!a.ok)throw Error((await a.json()).error||"Erro ao fazer upload da imagem");return a.json()}async changePassword(e,s){return this.request("/api/admin/users/".concat(e,"/change-password"),{method:"POST",body:JSON.stringify(s)})}async getAllowedRoles(){return this.request("/api/admin/allowed-roles")}async getStats(){return this.request("/api/stats")}async syncRoblox(e){return this.request("/api/roblox/sync",{method:"POST",body:JSON.stringify({placeIdOrUrl:e})})}async importGamepass(e,s){return this.request("/api/roblox/import-gamepass",{method:"POST",body:JSON.stringify({gameId:e,gamepassIdOrUrl:s})})}async getPartners(){return this.request("/api/partners")}async getPartner(e){return this.request("/api/partners/".concat(e))}async updatePartner(e,s){return this.request("/api/partners/".concat(e),{method:"PATCH",body:JSON.stringify(s)})}async createPartner(e){return this.request("/api/partners",{method:"POST",body:JSON.stringify(e)})}async deletePartner(e){return this.request("/api/partners/".concat(e),{method:"DELETE"})}async getAsaasSubaccounts(){return this.request("/api/asaas/subaccounts")}async createAsaasSubaccount(e){return this.request("/api/asaas/subaccounts",{method:"POST",body:JSON.stringify(e)})}async getAsaasBalance(){return this.request("/api/asaas/balance")}async getAsaasAccount(){try{return await this.request("/api/asaas/account")}catch(e){return null}}async getDiscordServerData(){let e=await this.request("/api/discord/server");return e.synced&&e.data||null}async getCoupons(){return this.request("/api/coupons")}async getCoupon(e){return this.request("/api/coupons/".concat(e))}async createCoupon(e){return this.request("/api/coupons",{method:"POST",body:JSON.stringify(e)})}async updateCoupon(e,s){return this.request("/api/coupons/".concat(e),{method:"PUT",body:JSON.stringify(s)})}async deleteCoupon(e){return this.request("/api/coupons/".concat(e),{method:"DELETE"})}async validateCoupon(e){return this.request("/api/coupons/validate",{method:"POST",body:JSON.stringify({code:e})})}async getAsaasCustomers(){return this.request("/api/asaas/customers")}async createAsaasCustomer(e){return this.request("/api/asaas/customers",{method:"POST",body:JSON.stringify(e)})}async getDeliveries(e){return this.request(e?"/api/deliveries?status=".concat(e):"/api/deliveries")}async getDelivery(e){return this.request("/api/deliveries/".concat(e))}async getDeliveryStats(){return this.request("/api/deliveries/stats")}async updateDeliveryStatus(e,s){return this.request("/api/deliveries/".concat(e,"/status"),{method:"PUT",body:JSON.stringify(s)})}async uploadDeliveryProof(e,s){return this.request("/api/deliveries/".concat(e,"/proof"),{method:"PUT",body:JSON.stringify({proofUrl:s})})}async getSellers(){return this.request("/api/sellers")}async getSeller(e){return this.request("/api/sellers/".concat(e))}async updateSeller(e,s){return this.request("/api/sellers/".concat(e),{method:"PATCH",body:JSON.stringify(s)})}constructor(){this.maxRetries=3,this.retryDelay=1e3}}let n=new r}},e=>{e.O(0,[779,606,441,255,358],()=>e(e.s=89352)),_N_E=e.O()}]);